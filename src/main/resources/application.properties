spring.config.import=optional:file:application-local.properties
spring.application.name=pneumaliback

server.port=${PORT:9999}
server.address=0.0.0.0
spring.datasource.url=${DB_URL}
spring.datasource.username=${DB_USERNAME}
spring.datasource.password=${DB_PASSWORD}
spring.datasource.driver-class-name=org.postgresql.Driver
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=${SHOW_SQL:false}
spring.jpa.open-in-view=false
spring.jpa.properties.hibernate.jdbc.lob.non_contextual_creation=true
spring.jpa.properties.hibernate.jdbc.batch_size=20
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true
spring.jpa.properties.hibernate.jdbc.fetch_size=25


# JWT Configuration
jwt.secret=${JWT_SECRET}
jwt.expiration=${JWT_EXPIRATION:86400000}
jwt.refresh-expiration=${JWT_REFRESH_EXPIRATION:604800000}

# Security Configuration
security.max-login-attempts=5
security.account-lockout-duration=30
app.cors.allowed-origins=${APP_CORS_ALLOWED_ORIGINS:*}

# Enable scheduling for token cleanup
spring.task.scheduling.pool.size=1

# Hikari Connection Pool (optimized for low memory)
spring.datasource.hikari.maximum-pool-size=3
spring.datasource.hikari.minimum-idle=1
spring.datasource.hikari.connection-timeout=20000
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.max-lifetime=600000
spring.datasource.hikari.leak-detection-threshold=60000

# Upload configuration
spring.servlet.multipart.max-file-size=50MB
spring.servlet.multipart.max-request-size=60MB
storage.root=uploads

# ===== CONFIGURATION EMAIL (Pattern Strategy) =====
# Provider: smtp (défaut, local) ou sendgrid (cloud: Render, Heroku)
app.mail.provider=${APP_MAIL_PROVIDER:smtp}
app.mail.from=${APP_MAIL_FROM:noreply@pneumali.ml}

# Configuration SMTP (utilisée si app.mail.provider=smtp)
spring.mail.host=${SPRING_MAIL_HOST:smtp.gmail.com}
spring.mail.port=${SPRING_MAIL_PORT:587}
spring.mail.username=${SPRING_MAIL_USERNAME}
spring.mail.password=${SPRING_MAIL_PASSWORD}

# Configuration SendGrid (utilisée si app.mail.provider=sendgrid)
app.mail.sendgrid.api-key=${SENDGRID_API_KEY}

# Admin emails for weekly suspicious report (comma-separated)
app.admin.emails=${APP_ADMIN_EMAILS:}
